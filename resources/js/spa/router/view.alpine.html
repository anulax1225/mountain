<template>
    <div x-ref="routerView">

    </div>
</template>

<script setup>
    return {
        prevPage: "",
        init() {
            effect(() => {
                let page = $store.router.currentPage;
                if (page === this.prevPage) return;
                else this.prevPage = page;
                if (!Alpine.compositor.hasComponent(page)) {
                    //console.log("[Alpine router] Dynamic page load of " + page)
                    Alpine.compositor.loadComponent(page);
                }
                const pageElement = document.createElement(page);
                $refs.routerView.innerHTML = "";
                $refs.routerView.appendChild(pageElement);
            });
        },
    }
</script>