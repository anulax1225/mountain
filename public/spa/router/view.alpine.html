<template>
    <ui-button class="border p-2 m-2" @click="showPage()">
        text
        <p x-text="show.value ? 'shown' : 'hidden'"></p>
    </ui-button>
    <div x-ref="routerView">

    </div>

</template>

<script setup>
    return {
        show: ref(false),
        init() {
            effect(() => {
                if(!this.show.value) {
                    $refs.routerView.innerHTML = "";
                    return;
                }

                let page = $store.router.currentPage;
                if (!Alpine.compositor.hasComponent(page)) {
                    console.log("[Alpine router] Dynamic page load of " + page)
                    Alpine.compositor.loadComponent(page);
                }
                $refs.routerView.innerHTML = ``;
                const pageNode = document.createElement(page);
                $refs.routerView.appendChild(pageNode);
            });
        },
        showPage() {
            console.log("show", $refs, $refs.routerView)
            this.show.value = !this.show.value;
        }
    }
</script>